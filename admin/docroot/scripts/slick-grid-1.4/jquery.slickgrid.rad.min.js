!function(t){t.fn.extend({slickGrid:function(i){if("string"==typeof i){if(t.slickGrid.isPublicMethod(i)){var e=t.slickGrid.getInstance(t(this),{},{});return e[i].apply(e,Array.prototype.slice.call(arguments,1))}return t.rad.notify.error("Error",i+" is not a valid slickgrid function!"),this}if("object"==typeof i){var s=arguments[1];return this.each(function(){t.slickGrid.getInstance(t(this),i,s)})}return t.rad.notify.error("Error","Unrecognized parameter type"),this},slickSetData:function(i,e){slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.setData(i,e||null)},slickUpdateGrid:function(i){slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.updateGrid(i)},slickShowLoadingIndicator:function(){slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.showLoadingIndicator(t(this))},slickHideLoadingIndicator:function(){slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.hideLoadingIndicator()},slickUpdateItem:function(i){return slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.updateItem(i)},slickGetItems:function(){return slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.getItems()},slickGetAllColumns:function(){return slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.getAllColumns()},slickGetCurrentColumns:function(){return slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.getCurrentColumns()},slickSetColumns:function(i){return slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.setColumns(i)},slickRemoveRow:function(i){return slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.removeRow(i)},slickRender:function(){return slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.renderGrid()},slickGetDataView:function(){return slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.getDataView()},slickViewPort:function(){return slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.getViewPort()},slickReloadData:function(i,e){return slickInstance=t.slickGrid.getInstance(t(this),{},{}),slickInstance.reloadData(i,e),!0}}),t.extend({slickGrid:function(t,i,e){return this.init(t,i,e)}}),t.extend(t.slickGrid,{getInstance:function(i,e,s){if(i.data("slickGridData"))return i.data("slickGridData");var n=new t.slickGrid(i,e,s);return i.data("slickGridData",n),n},getPublicMethods:function(){return["setData","updateGrid","showLoadingIndicator","hideLoadingIndicator","getAllColumns","getCurrentColumns","setCurrentColumns","setColumns","updateItem","getItems","removeRow","renderGrid","getDataView","getViewPort","reloadData"]},isPublicMethod:function(i){var e=t.slickGrid.getPublicMethods();return t.inArray(i,e)>-1}}),t.slickGrid.prototype={_domObject:null,_grid:null,_dataView:null,_columnPicker:null,_pager:null,_toppager:null,_columns:null,_loadingIndicator:null,_useLoadingIndicator:!1,_aggregationIteration:null,_idProperty:null,_data:null,_facts:null,_sumDuplicates:null,_filter:null,_currSortCol:null,_currSortAsc:null,_cookie:null,_form:null,_windowInitialOffset:null,init:function(e,s,n){var r=this;this._domObject=e,this._dataView=new Slick.Data.DataView;var o=this._dataView;!n&&s.slickOptions?n=s.slickOptions:n||(n={});var a=t.extend({},t.slickGrid.defaults.rad,s),c=t.extend({},t.slickGrid.defaults.slick,n);s=null,n=null,a.pagingOptions&&o.setPagingOptions(a.pagingOptions),a.form&&(this._form=a.form,o.setForm(a.form)),a.columns||t.rad.notify.error("Error","You must include columns in the rad_options portion of the slickGrid constructor"),this._facts=[],t.each(a.columns,function(){if(a.useTooltips){var e=[];Slick.Controls&&Slick.Controls.ColumnPicker&&e.push("Right click for column picker"),0!=c.enableColumnReorder&&e.push("Drag to reorder");var s=this.name;s.length>0&&(s="<b>"+s+"</b><br />");var n="";this.sortable&&(n="Left click for sort",e.length>0&&(n+="<br />")),this.toolTip=s+n+e.join("<br />")}if(this.formatter){var o;"object"==typeof this.formatter?(o=r.getFormatters(this.formatter.options),this.formatter=o[this.formatter.name]):"string"==typeof this.formatter&&(o=r.getFormatters(),this.formatter=o[this.formatter])}this.id||t.rad.notify.error("Error in column "+(i+1),"You must provide at least an id field in the column"),this.field||(this.field=this.id),this.type||(this.type="string"),this.def_value||(this.def_value=""),this.fact&&r._facts.push(this)}),this._columns=a.columns,this._grid=new Slick.Grid(t(e),o.rows,this._columns,c);var l=this._grid;Slick.Controls&&Slick.Controls.ColumnPicker&&(this._columnPicker=new Slick.Controls.ColumnPicker(this._columns,l)),a.pager&&Slick.Controls&&Slick.Controls.Pager&&(new Slick.Controls.Pager(this._dataView,this._grid,a.pager),this._pager=a.pager),a.toppager&&Slick.Controls&&Slick.Controls.Pager&&(new Slick.Controls.Pager(this._dataView,this._grid,a.toppager),this._toppager=a.toppager);var d=function(){if(r._cookie){var i=r._grid.getSortInfo(),e=r._grid.getColumns(),s=t.map(e,function(t,e){var s=t.id+","+t.width;return t.id==i.sortColumnId&&(s+=","+(i.sortAsc?"asc":"desc")),s}).join("|");t.cookie(r._cookie,s,{path:"/"})}};a.idProperty&&(this._idProperty=a.idProperty),a.useTooltips&&t(".slick-header-column").simpletooltip(),void 0!=a.useLoadingIndicator&&(this._useLoadingIndicator=a.useLoadingIndicator),a.useFilter&&(a.callbacks&&a.callbacks.filter?(this._filter=a.callbacks.filter,delete a.callbacks.filter):this._filter=function(t){if(null!==t.parent)for(var i=r._dataView.getItemByIdx(t.parent);null!==i;){if(i._collapsed)return!1;i=null!==i.parent?r._dataView.getItemByIdx(i.parent):null}return!0}),a.sumDuplicates&&(this._sumDuplicates=!0),a.callbacks&&t.each(a.callbacks,function(t,i){l[t]=i});t(e);if(this._loadingIndicator=t("<span class='loading-indicator'><label>Loading...</label></span>").hide().appendTo(document.body),this.showLoadingIndicator(t(e)),this._currSortAsc=!0,a.sortBy){var u,r=this;if("string"==typeof a.sortBy){var h=a.sortBy.split(" ");u=h[0],h[1]&&(this._currSortAsc=!("desc"==h[1]))}else"object"==typeof a.sortBy&&(u=a.sortBy.column,this._currSortAsc=!("desc"==a.sortBy.dir));t.each(this._columns,function(){this.id==u&&(r._currSortCol=this)})}if(l.onSort=function(t,i){d(t,i),void 0!=t.sort_field?o.fastSort(t.sort_field,i):o.fastSort(t.field,i)},a.width&&"auto"!==a.width)if("fit"!==a.width)t(e).width(a.width);else{if(!this._windowInitialOffset){var f=t(window).width()-(t(e).offset().left+t(e).width());this._windowInitialOffset=f>0?f:25}t(window).resize(function(){t(e).children().css("width","99.9%"),t(e).css("overflow-x","hidden")}).resize(),t(e).trigger("resize")}a.width&&"auto"!==a.width||l.onResizeCanvas||(l.onResizeCanvas=function(t){t.container.width(t.width)}),a.cookie&&(this._cookie=a.cookie),l.onColumnsReordered||(l.onColumnsReordered=d),l.onColumnsResized||(l.onColumnsResized=d),l.onColumnsSelected||(l.onColumnsSelected=d),l.onValidationError||(l.onValidationError=function(i,e,s,n,r){t.rad.notify.error("Error",e.msg)}),o.onRowCountChanged.subscribe(function(t){l.updateRowCount(),l.render()}),o.onRowsChanged.subscribe(function(t){l.removeRows(t),l.render()}),o.onDataLoading.subscribe(function(i){t(e).slickShowLoadingIndicator()}),o.onDataLoaded.subscribe(function(i){t(e).slickHideLoadingIndicator()});var p=[],g=null;return null!==this._cookie&&(g=t.cookie(this._cookie)),null!==g?(t.each(g.split("|"),function(i,e){var s=e.split(","),n=s[0],a=s[1],c=s[2];t.each(r._columns,function(){this.id==n&&(void 0!==c&&null!==c&&(r._currSortCol=this,r._currSortAsc=!("desc"==c),this.sort_field?o.sort(this.sort_field,r._currSortAsc):o.sort(this.id,r._currSortAsc)),this.width=parseInt(a),p.push(this))})}),this._grid.setColumns(p)):(t.each(r._columns,function(){this.hidden||p.push(this)}),this._grid.setColumns(p)),this},getFormatters:function(i){var e=function(e,s,n,r,o){return t.rad.formatters.currency(n,i)},s=function(e,s,n,r,o){return t.rad.formatters.numeric(n,i)},n=function(t,i,e,s,n){return e>=1?"<img src='/images/slick-grid/tick.png'>":""},r=function(e,s,n,r,o){return t.rad.formatters.date(n,i)};return{currency:e,numeric:s,bool:n,date:r}},submitForm:function(){var t=this;t._form.trigger("submit")},reloadData:function(t,i){this.showLoadingIndicator(this._domObject),this.setData(t,i),this.updateGrid(),this.hideLoadingIndicator()},setData:function(i,e){var s=this;if(null!=e){var n={root:!1,children:!0};if(i.input&&i.input.Expansion)switch(i.input.Expansion){case"expand":n.root=!1,n.children=!1;break;case"collapse":n.root=!0,n.children=!0;break;case"root-only":n.root=!1,n.children=!0}s._aggregationIteration=-1;var r={},o={};t.each(s._facts,function(){r[this.field]=this.def_value,o[this.field]=this.type});var a={leaf:!1,name:"grand total",facts:r,types:o,_collapsed:n.root,id:"slick-row-"+Math.floor(Math.random()*new Date)};i.entries?t.each(i.entries,function(i,r){var o=a;t.each(e,function(i,e){var a=e.get(r);o.children||(o.children={}),o.children[a]?s._sumDuplicates&&t.each(s._facts,function(){var i=this,e=i.field.split(/[.]/),s=r;t.each(e,function(){s&&(s=s[this])});var n=s||i.def_value;switch(i.type){case"integer":n=parseInt(n);break;case"float":n=parseFloat(n)}o.children[a].facts[i.field]+=n}):(o.children[a]={id:"slick-row-"+Math.floor(Math.random()*new Date),type:e.id,name:e.text(r),leaf:!1,facts:{},types:{},_collapsed:n.children},t.each(s._facts,function(){var i=this,e=i.field.split(/[.]/),s=r;t.each(e,function(){s&&(s=s[this])});var n=s||i.def_value;switch(i.type){case"integer":n=parseInt(n);break;case"float":n=parseFloat(n)}o.children[a].facts[i.field]=n,o.children[a].types[i.field]=i.type})),o=o.children[a]}),0==e.length&&t.each(s._facts,function(){var i=this,e=i.field.split(/[.]/),s=r;t.each(e,function(){s&&(s=s[this])});var n=s||i.def_value;switch(i.type){case"integer":n=parseInt(n);break;case"float":n=parseFloat(n)}o.facts[i.field]=n,o.types[i.field]=i.type}),o.leaf=!0,delete o._collapsed}):a.leaf=!0,s._data=s.aggregate([],a,0,[],null)}else objects=[],i.entries?t.each(i.entries,function(i,e){var n={id:"slick-row-"+Math.floor(Math.random()*new Date)};e.css_class&&(n.css_class=e.css_class),e.extra_data&&(n.extra_data=e.extra_data),t.each(s._columns,function(){var i=this.field.split(/[.]/),s=e;t.each(i,function(){s&&(s=s[this])}),n[this.field]=s||this.def_value}),objects.push(n)}):this.hideLoadingIndicator(),s._data=objects,objects=null;return t(this._domObject)},updateGrid:function(i){return i&&(this._data=i),this._dataView.beginUpdate(),null!==this._idProperty?this._dataView.setItems(this._data,this._idProperty):this._dataView.setItems(this._data),null!==this._filter&&this._dataView.setFilter(this._filter),this._dataView.endUpdate(),this.hideLoadingIndicator(),t(window).resize(),this._currSortCol&&(this._grid.setSortColumn(this._currSortCol.id,this._currSortAsc),this._grid.onSort(this._currSortCol,this._currSortAsc)),t(".slick-row").live("mouseover mouseout",function(i){"mouseover"==i.type?t(this).addClass("ui-state-hover"):t(this).removeClass("ui-state-hover")}),null!=this._pager&&t(this._pager).find(".slick-pager").addClass("ui-corner-bottom").css("border-top","1px solid #AAAAAA"),t(this._domObject)},showLoadingIndicator:function(i){return void 0===i&&(i=t(this._domObject)),this._useLoadingIndicator&&this._loadingIndicator.css("position","absolute").css("top",i.offset().top+i.height()/2-this._loadingIndicator.height()/2).css("left",i.offset().left+i.width()/2-this._loadingIndicator.width()/2).show(),i},hideLoadingIndicator:function(){return this._loadingIndicator&&this._loadingIndicator.fadeOut(),t(this._domObject)},updateItem:function(t){return this._dataView.updateItem(t.id,t)},getItems:function(){return this._dataView.getItems()},getAllColumns:function(){return this._columns},getCurrentColumns:function(){return this._grid.getColumns()},setColumns:function(i){return this._grid.setColumns(i),t(this._domObject)},removeRow:function(i){return this._grid.removeRow(i),t(this._domObject)},renderGrid:function(){return this._grid.render(),t(this._domObject)},getDataView:function(){return this._dataView},getViewPort:function(){return this._grid.getViewport()}},t.slickGrid.editor={args:null,defaultValue:null,wrapper:null,_display:function(){return this.position(this.args.position),this.focus()},init:function(i){return this.args=i,this.loadValue(i.item),this.wrapper=t("<div />"),$input=t('<input type="text" name="'+this.args.column.field+'" />').appendTo(this.wrapper),$input.val(this.defaultValue),this.wrapper.appendTo(this.args.container),this.focus()},handleKeyDown:function(i){i.which==t.ui.keyCode.ENTER&&i.ctrlKey?this.save():i.which==t.ui.keyCode.ESCAPE?(i.preventDefault(),this.cancel()):i.which==t.ui.keyCode.TAB&&i.shiftKey?(i.preventDefault(),this.save(),this.args.grid.navigatePrev()):i.which==t.ui.keyCode.TAB&&(i.preventDefault(),this.save(),this.args.grid.navigateNext())},handleClick:function(t,i,e){this.save()},destroy:function(){return this.wrapper.remove(),this},save:function(){return this.args.commitChanges(),this},cancel:function(){return this.args.cancelChanges(),this},focus:function(){return t(":input:visible:first",this.wrapper).focus(),this},_position:function(i){var e=i.bottom-i.top,s=i.right-i.left,n=this.wrapper.innerWidth(),r=t(".slickgrid-edit-form-handle",this.wrapper);return 0==r.length&&(r=t('<div class="slickgrid-edit-form-handle" />').css({position:"absolute",top:"3px",width:"0px",height:"0px","line-height":"0px","border-style":"solid","border-width":"5px"}).hover(function(){t(this).css("cursor","move")},function(){t(this).css("cursor","")}).appendTo(this.wrapper)),this.wrapper.draggable({handle:".slickgrid-edit-form-handle"}),this.wrapper.css("top",i.top+.66*e),i.left+.75*s+this.wrapper.width()>t(window).width()?(this.wrapper.css("left",i.left+.25*s-n),r.css({right:"3px","border-color":"#bbb #bbb white white"})):(this.wrapper.css("left",i.left+.75*s),r.css({left:"3px","border-color":"#bbb white white #bbb"})),this.wrapper.show(),this},position:function(t){return this.wrapper.show(),this},loadValue:function(t){return void 0!=t[this.args.column.field]&&(this.defaultValue=t[this.args.column.field]),this},isValueChanged:function(){return!0},validate:function(){return{valid:!0,msg:null}},serializeValue:function(){return this.args.item},applyValue:function(i,e){i=e;var s=t('input[name="'+this.args.column.field+'"]').val();return i[this.args.column.field]=s,this}},t.slickGrid.defaults={slick:{editable:!1,autoEdit:!1,enableAddRow:!1,leaveSpaceForNewRows:!1,autoHeight:!0,enableRowReordering:!1,enableAutoTooltips:!1},rad:{useTooltips:!1,useFilter:!1,sumDuplicates:!1,width:"fit",pagingOptions:{pageSize:25,pageNum:1},useLoadingIndicator:!1}}}(jQuery);