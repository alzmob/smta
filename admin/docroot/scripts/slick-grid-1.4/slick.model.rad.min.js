function EventHelper(){return this.handlers=[],this.subscribe=function(e){this.handlers.push(e)},this.notify=function(e){for(var n=0;n<this.handlers.length;n++)this.handlers[n].call(this,e)},this}!function(e){function n(){function n(){j=!0}function t(){j=!1,C()}function o(){x={},e.each(D,function(e,n){if(void 0!=n){if(n._id instanceof Object)var t=n._id.$id;else var t=n._id;if(void 0==t||void 0!=x[t])throw window.console&&console.log(n),window.console&&console.log(t),"Each data element must implement a unique 'id' property or the 'id' is 0";x[t]=e}})}function r(){return O}function a(n){O=n,e(O).form(function(n){server_page_num=0,server_page_size=0,n.pagination&&(server_page_num=parseInt(n.pagination.page)-1,server_page_size=parseInt(n.pagination.items_per_page),parseInt(n.pagination.total_rows)!=A&&(D={},A=parseInt(n.pagination.total_rows)),$.notify(l())),offset=parseInt(server_page_size)*parseInt(server_page_num),n.entries&&e.each(n.entries,function(e,n){D[offset+e]=n}),o(),t(),J.notify({from:offset,to:offset+U})},{keep_form:!0})}function s(){return D}function f(e,n){void 0!==n&&(b=n),D=e,o(),C()}function u(e){void 0!=e.pageSize&&(U=e.pageSize),void 0!=e.totalRows&&(A=e.totalRows),void 0!=e.pageNum&&(q=Math.min(e.pageNum,Math.ceil(A/U))),$.notify(l()),C()}function l(){return{pageSize:U,pageNum:q,totalRows:A}}function p(n,t){_form=r(),e("input[name=sort]",_form).val(n),t===!1?e("input[name=sord]",_form).val("DESC"):e("input[name=sord]",_form).val("ASC"),R()}function c(e,n){return p(e,n)}function g(){F?p(F,k):L&&c(L,k)}function d(e){N=e,C()}function m(e){return D[e]}function h(e){return x[e]}function v(e){if(!M){M={};for(var n=0,t=B.length;t>n;++n)M[B[n][b]]=n}return M[e]}function _(e){return D[x[e]]}function I(e,n){if(void 0===x[e]||e!==n[b])throw"Invalid or non-matching id";D[x[e]]=n,P||(P={}),P[e]=!0,C()}function w(e,n){D.splice(e,0,n),o(),C()}function y(e){D.push(e),o(),C()}function E(n,t){e.each(t,function(e){D.splice(n+e,0,this)}),o(),C()}function S(e){if(void 0===x[e])throw"Invalid id";D.splice(x[e],1),o(),C()}function z(n,t,i,o){var r=[],a=n,s=t,f=i,u=o;M=null;var l,p=s.length,c=0,g=0;return e.each(a,function(e,n){c=e,l=n.id,(!f||f(n))&&(!U||c>=U*q&&U*(q+1)>c)&&((g>=p||l!=s[g][b]||u&&u[l])&&(r[r.length]=g),s[g]=n,g++)}),p>g&&s.splice(g,p-g),r}function C(){if(!j){if(!H())return n(),R(),!1;var e=B.length,t=A,i=z(D,B,N,P);U&&q*U>A&&(q=Math.floor(A/U),i=z(D,B,N,P)),P=null,t!=A&&$.notify(l()),e!=B.length&&Q.notify({previous:e,current:B.length}),i.length>0&&V.notify(i)}}function H(){for(offset=parseInt(U)*parseInt(q),i=offset;i<offset+parseInt(U);i++)if(i<A&&(void 0==D[i]||null==D[i]))return!1;return!0}function R(){_form=r(),offset=parseInt(U)*parseInt(q),items_per_page=e("input[name=items_per_page]",_form).val(),server_page=parseInt(offset/parseInt(items_per_page)),e("input[name=page]",_form).val(server_page+1),null!=T&&clearTimeout(T),T=setTimeout(function(){G.notify({from:offset,to:offset+items_per_page}),r().trigger("submit")},50)}var b="_id",D={},B=[],x={},M=null,N=null,P=null,j=!1,k=!0,F=null,L=null,O=null,T=null,U=0,q=0,A=0,Q=new EventHelper,V=new EventHelper,$=new EventHelper,G=new EventHelper,J=new EventHelper;return{rows:B,beginUpdate:n,endUpdate:t,setPagingOptions:u,getPagingInfo:l,getItems:s,setItems:f,setFilter:d,sort:p,fastSort:c,reSort:g,getIdxById:h,getRowById:v,getItemById:_,getItemByIdx:m,refresh:C,updateItem:I,insertItem:w,insertItems:E,addItem:y,deleteItem:S,setForm:a,onRowCountChanged:Q,onRowsChanged:V,onPagingInfoChanged:$,onDataLoading:G,onDataLoaded:J}}e.extend(!0,window,{Slick:{Data:{DataView:n}}})}(jQuery);